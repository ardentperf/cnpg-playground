echo "Setting KUBECONFIG to {{ script_dir }}/k8s/kube-config.yaml"
export KUBECONFIG={{ script_dir }}/k8s/kube-config.yaml
cd {{ script_dir }}
# Only auto-enter nix develop if not already inside, and only for login interactive shells
if [ -z "$IN_NIX_SHELL" ] && [ -z "$CNPG_DEV_ENTERED" ] && [[ "$-" == *i* ]]; then
    export CNPG_DEV_ENTERED=1
    echo "Entering nix development environment..."
    if nix develop .; then
        echo "nix develop . completed successfully."
    else
        echo "nix develop . failed. Please check the output above for errors."
    fi
else
    echo "Already inside a nix environment or already entered. Skipping 'nix develop .'."
fi