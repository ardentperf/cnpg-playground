echo "Setting KUBECONFIG to {{ script_dir }}/k8s/kube-config.yaml"
export KUBECONFIG={{ script_dir }}/k8s/kube-config.yaml
cd {{ script_dir }}
# Only auto-enter nix develop if not already inside, and only for login interactive shells
if [ -z "$IN_NIX_SHELL" ] && [ -z "$CNPG_DEV_ENTERED" ] && [[ "$-" == *i* ]]; then
    export CNPG_DEV_ENTERED=1
    echo "Entering nix development environment..."
    if nix develop .; then
        echo "nix develop . completed successfully."
    else
        echo "nix develop . failed. Please check the output above for errors."
    fi
else
    echo "Already inside a nix environment or already entered. Skipping 'nix develop .'."
    echo ""
    echo ""
    echo "**********************************************************************"
    echo "**                Welcome to the CloudNativePG Lab                  **"
    echo "**                                                                  **"
    echo "** ğŸ“¦ Docker containers = âš™ï¸ Kubernetes nodes (KIND cluster)         **"
    echo "**                                                                  **"
    echo "**   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    **"
    echo "**   â”‚  Docker       â”‚    â”‚  Docker       â”‚    â”‚  Docker       â”‚    **"
    echo "**   â”‚  Container    â”‚    â”‚  Container    â”‚    â”‚  Container    â”‚    **"
    echo "**   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚               â”‚    **"
    echo "**   â”‚  â”‚  pod-1  â”‚  â”‚    â”‚  â”‚  pod-3  â”‚  â”‚    â”‚ S3 API/Web UI â”‚    **"
    echo "**   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚               â”‚    **"
    echo "**   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  {pg backup}  â”‚    **"
    echo "**   â”‚  â”‚  pod-2  â”‚  â”‚    â”‚  â”‚  pod-4  â”‚  â”‚    â”‚               â”‚    **"
    echo "**   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚ MinIO Object  â”‚    **"
    echo "**   â”‚  Kubernetes   â”‚    â”‚  Kubernetes   â”‚    â”‚ Storage       â”‚    **"
    echo "**   â”‚  Node/Server  â”‚    â”‚  Node/Server  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    **"
    echo "**   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         **"
    echo "**                                                                  **"
    echo "** A few useful commands:                                           **"
    echo "**   btop - show system utilization (cpu, io, network, procs, etc)  **"
    echo "**   bat - syntax-highlighted file viewer                           **"
    echo "**   k9s - terminal UI for Kubernetes (aka "k8s")                   **"
    echo "**   lazydocker - terminal UI for Docker: nodes/servers in this Lab **"
    echo "**   k or kubectl - Kubernetes command line tool                    **"
    echo "**   kc or kubectl cnpg - CNPG plugin for kubectl                   **"
    echo "**   c or kubectx - switch between Kubernetes contexts              **"
    echo "**   n or kubens - switch between Kubernetes namespaces             **"
    echo "**                                                                  **"
    echo "** scripts/setup.sh                                                 **"
    echo "**                   creates k8s-eu and k8s-us Kubernetes clusters  **"
    echo "** LEGACY=true demo/setup.sh                                        **"
    echo "**                   creates pg-eu and pg-us CloudNativePG clusters **"
    echo "**********************************************************************"
fi